-- Create database for products
CREATE DATABASE products_db;
-- Create a schema named 'product_schema'
CREATE SCHEMA product_schema;

-- Drop table if exists
DROP TABLE IF EXISTS product_schema.product CASCADE;

-- Create schema if not exists
CREATE SCHEMA IF NOT EXISTS product_schema;

-- Create the table
CREATE TABLE product_schema.product (
    id BIGSERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    brand VARCHAR(255),
    price NUMERIC(10,2),
    category VARCHAR(255),
    release_date DATE,
    product_available BOOLEAN,
    stock_quantity INT,
    image_name VARCHAR(255),
    image_type VARCHAR(100),
    image_data BYTEA
);

-- Reset sequence to 1 (so next insert gets ID=1 if table is empty)
ALTER SEQUENCE product_schema.product_id_seq RESTART WITH 1;


-- Insert Data into Table product
INSERT INTO product_schema.product
(
    name,
    description,
    brand,
    price,
    category,
    release_date,
    product_available,
    stock_quantity,
    image_name,
    image_type,
    image_data
)
VALUES
(
    'Sample Product',
    'This is a sample product description.',
    'SampleBrand',
    199.99,
    'Electronics',
    '2026-01-16',
    true,
    50,
    'sample.jpg',
    'image/jpeg',
    decode('FFD8FFE0', 'hex') -- small dummy JPEG header in hex
);
-- Select Data
SELECT table_schema, table_name FROM information_schema.tables WHERE table_schema = 'product_schema';
SELECT * FROM product_schema.product;
-- Drop the table
DROP TABLE IF EXISTS product_schema.product;
TRUNCATE TABLE product RESTART IDENTITY CASCADE;

-- Drop All tables
-- Drop tables safely in PostgreSQL
DROP TABLE IF EXISTS product_schema.order_items CASCADE;
DROP TABLE IF EXISTS product_schema.orders CASCADE;
DROP TABLE IF EXISTS product_schema.product CASCADE;
